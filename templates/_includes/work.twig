{% set work = craft.entries.section('work').all() ?? [] %}

{% if work|length %}

  <section
    x-cloak
    x-data="{
      showSlideover: false,
      selected: null,

      setSlideover: function (id) {
        this.selected = id;
        this.showSlideover = true;
      },
    }"
  >
    <h2 class="sr-only">Recent work</h2>

    {# Work card grid #}
    <div class="grid grid-cols-12 gap-y-24 lg:gap-x-16">
      {% for entry in craft.entries.section('work').all() %}

        {% set image = entry.cardImage.one() ?? null %}
        {% set cls = "" %}

        {# Vertical stacking #}
        {% if ((loop.index0 % 6) + 1 == 2)
          or ((loop.index0 % 6) + 1 == 5)
          or ((loop.index0 % 6) + 1 == 6)
        %}
          {% set cls = "ml-auto lg:ml-0" %}
        {% endif %}

        {# Three to a row with blanks #}
        {% if ((loop.index0 % 10) + 1) == 3
          or ((loop.index0 % 12) + 1) == 9
        %}
          <div class="hidden xl:block xl:col-span-4">{# blank grid space #}</div>
        {% endif %}

        {# Three to a row with blanks #}
        {% if ((loop.index0 % 12) + 1) == 3
          or ((loop.index0 % 12) + 1) == 6
          or ((loop.index0 % 12) + 1) == 9
          or ((loop.index0 % 12) + 1) == 13
        %}
          <div class="hidden xl:block xl:col-span-4">{# blank grid space #}</div>
        {% endif %}

        <div class="relative col-span-full space-y-5 w-full max-w-[480px] lg:max-w-none lg:col-span-6 xl:col-span-4 {{ cls }}">
          <h2 class="heading3-mono">{{ entry.title }}</h2>

          {% if image %}
            <div class="aspect-[480/288] shadow-sm">
              {% include "_includes/picture" with {
                disableAlt: true,
                image: image,
                mode: "crop",
                classes: "object-cover w-full h-full",
                ratio: [480, 288],
                pictureSets: [
                  { "467": [560, null] },
                  { "default": [414, null] },
                ],
              } only %}
            </div>
          {% endif %}

          {% include "_includes/workCardMeta" with {
            type: entry.workType,
            year: entry.year,
            agency: entry.agency,
            langAlt: langAlt
          } %}

          <a
            @click.prevent="setSlideover({{ entry.id }})"
            @keydown.space.prevent="setSlideover({{ entry.id }})"
            href="{{ url(entry.uri) }}"
            class="box-link before:focus-visible:outline before:focus-visible:outline-2 before:focus-visible:outline-offset-2 before:focus-visible:outline-blue-700"
            aria-label="{{ 'View details, opens dialog'|t }}"
          ></a>
        </div>

      {% endfor %}
    </div>

    {# Slideover #}
    <div
      x-dialog
      x-model="showSlideover"
      style="display: none"
      class="fixed inset-0 overflow-auto z-10"
    >
      {# Backdrop overlay #}
      <div
        x-dialog:overlay
        x-transition.opacity.duration.300ms
        class="fixed inset-0 bg-[#dfdfdf]/65 backdrop-blur-lg"
      ></div>

      {# Panel background (white fill) #}
      <div
        class="fixed inset-y-0 right-0 bg-white w-[clamp(818px,1509px,87%)] 3xl:w-[var(--3xl-panel-w)]"
        x-show="showSlideover"
        x-transition:enter="transition duration-200"
        x-transition:enter-start="translate-x-8 opacity-0"
        x-transition:enter-end="translate-x-0 opacity-100"
        x-transition:leave="transition duration-200"
        x-transition:leave-start="translate-x-0 opacity-100"
        x-transition:leave-end="translate-x-8 opacity-0"
      ></div>

      {# Panel #}
      <div
        x-dialog:panel
        class="fixed inset-y-0 right-0 w-[clamp(818px,1509px,87%)] 3xl:w-[var(--3xl-panel-w)]"
      >
        <div
          x-show="showSlideover"
          x-transition.opacity.duration.300ms
          class="fixed inset-0 pointer-events-none overflow-auto"
        >
          <div class="container">

            {# Close button #}
            <div class="sticky top-0 inset-x-0 pointer-events-none pt-8 md:pt-[52px] 2xl:pt-[60px]">
              <div class="flex justify-end">
                <button
                  type="button"
                  @click="$dialog.close()"
                  class="pointer-events-auto focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2"
                >
                  <span class="sr-only">Close slideover</span>
                  {{ svg('@webroot/dist/images/icon--close.svg', true, true)|attr({ class: 'classes' }) }}
                </button>
              </div>
            </div>

            <div class="grid grid-cols-12 gap-x-16">
              <div class="col-span-9 col-start-3 pointer-events-auto">

                {# Body #}
                <div class="pt-[200px] md:pt-[264px] 2xl:pt-[198px]">

                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>
                  <p>
                    Nostrud pariatur deserunt sit laboris pariatur do labore laboris est sit.
                    Nulla culpa consequat ipsum consequat minim proident aliqua esse in tempor.
                    Irure ex incididunt veniam in aliqua adipisicing quis laboris sint magna
                    mollit anim veniam. Eu non enim officia minim ipsum laboris eiusmod occaecat
                    eu ea ad nostrud cillum sint.
                  </p>

                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div> {# /Slideover #}

  </section>

{% endif %}

